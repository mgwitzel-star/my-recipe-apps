<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Smart Kitchen Pro</title>
    <style>
        :root { --primary: #2ecc71; --dark: #2c3e50; --gray: #f4f7f6; --blue: #3498db; --red: #e74c3c; --purple: #9b59b6; }
        body { font-family: system-ui, sans-serif; margin: 0; background: var(--gray); padding: 10px; padding-bottom: 50px; }
        .container { max-width: 500px; margin: 0 auto; }
        .card { background: white; padding: 15px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 15px; }
        h2 { margin-top: 0; font-size: 1.1rem; color: var(--dark); border-bottom: 2px solid #eee; padding-bottom: 8px; }

        input, textarea, select { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; font-size: 16px; }
        button { border: none; padding: 12px; border-radius: 8px; font-weight: bold; cursor: pointer; color: white; transition: 0.2s; }
        button:active { transform: scale(0.95); }
        .btn-main { background: var(--primary); width: 100%; }
        .btn-purple { background: var(--purple); width: 100%; margin-top: 5px; }
        .btn-outline { background: white; border: 2px solid var(--blue); color: var(--blue); padding: 5px 10px; font-size: 0.8rem; }
        
        .status-msg { font-size: 0.8rem; padding: 8px; color: var(--purple); font-style: italic; display: none; }
        .day-row { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #eee; }
        .recipe-item { display: flex; align-items: center; gap: 12px; padding: 10px 0; border-bottom: 1px solid #eee; }
        .recipe-img { width: 50px; height: 50px; border-radius: 8px; object-fit: cover; background: #ddd; }
        .budget-bar { background: var(--dark); color: white; padding: 15px; border-radius: 12px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; position: sticky; top: 5px; z-index: 100; }
    </style>
</head>
<body>

<div class="container">
    <div class="budget-bar">
        <span>Est. Weekly Budget</span>
        <span id="budgetDisplay" style="font-size: 1.4rem;">$0.00</span>
    </div>

    <div class="card" style="border-left: 5px solid var(--blue);">
        <h2>üìÖ Weekly Plan</h2>
        <div id="calendar-area"></div>
        <button class="btn-main" style="background: var(--dark); margin-top: 10px;" onclick="syncPlan()">üõí Sync Plan to Shopping List</button>
    </div>

    <div class="card" style="border: 2px solid var(--purple);">
        <h2 style="color: var(--purple);">‚ö° Web Scraper</h2>
        <input type="text" id="urlInput" placeholder="Paste AllRecipes or Food.com URL">
        <div id="scrapeStatus" class="status-msg">Reading recipe...</div>
        <button class="btn-purple" id="scrapeBtn" onclick="runScraper()">Fetch Recipe Data</button>
    </div>

    <div class="card">
        <h2 id="formTitle">üìù Recipe Editor</h2>
        <input type="hidden" id="editId">
        <input type="text" id="name" placeholder="Recipe Name">
        <input type="text" id="img" placeholder="Image URL (Optional)">
        <textarea id="ings" rows="5" placeholder="Ingredients (e.g. 1 cup Milk, Dairy)"></textarea>
        <button class="btn-main" onclick="saveRecipe()">Save to Cookbook</button>
    </div>

    <div class="card">
        <h2>üë®‚Äçüç≥ My Cookbook</h2>
        <div id="recipe-area"></div>
    </div>

    <div class="card">
        <h2>üõí Shopping List</h2>
        <div id="grocery-area"></div>
        <button class="btn-main" style="background: #95a5a6; margin-top: 15px;" onclick="clearGroceries()">Clear List</button>
    </div>
</div>

<script>
    let recipes = JSON.parse(localStorage.getItem('ck_recipes')) || [];
    let plan = JSON.parse(localStorage.getItem('ck_plan')) || { Mon:"", Tue:"", Wed:"", Thu:"", Fri:"", Sat:"", Sun:"" };
    let groceries = JSON.parse(localStorage
